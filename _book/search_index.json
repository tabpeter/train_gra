[["the-basics-t-tests-anova-and-linear-regression.html", "Chapter 9 The basics: t-tests, ANOVA, and linear regression 9.1 t-tests &amp; ANOVA 9.2 Linear regression", " Chapter 9 The basics: t-tests, ANOVA, and linear regression The most basic statistical analyses for a GRA to use are t-tests, analysis of variance, and linear regression. Here are some tips and references for getting started using any of these tools: 9.1 t-tests &amp; ANOVA Many t-test and ANOVA results can be implemented by the same functions I’ve suggested for creating summary tables. 9.1.1 Assumptions/diagnostics 9.1.2 Examples: 9.1.3 R code tips 9.2 Linear regression 9.2.1 Assumptions/diagnostics As the regression diagnostics page at Boston University explains, there are 4 key assumptions in linear regression: Linearity: the data \\(X\\) are in a linear relationship with the mean of the outcome \\(\\hat Y\\) Homoskedasticity: The variance of the residual \\(\\sigma^2\\) is the same for all observations of \\(X\\). Independence: For all observations \\(i\\) and \\(j\\), \\(i \\perp j\\). Normality: The residuals \\(\\textbf{r} \\equiv Y - X\\beta\\) are distributed normally. When using a linear model, here are the diagnostics you should check: Check the linearity assumption: make a plot of the residuals \\(\\textbf{r}\\) versus the fitted values \\(\\hat{\\mathbf{Y}}\\). If this assumption holds, you should see a horizontal line without a distinct pattern. Patterns like a cone-shape or a curve are red flags. Check the normality assumption: Make a QQ plot of the residuals using qqnorm and qqline. If the normality assumption is reasonable, the points should fall on the diagonal line drawn by qqline. You could also make a histogram of the residuals and see if the histogram has a bell-curve shape. Note: plotting the observed outcomes \\(Y\\) is not the same as checking this assumption. The linearity assumption pertains to the residuals being bell-curve shaped, not the observed outcome values. Check the heteroskedasticity assumption: Plot the standardized residuals versus the fitted values (this is a scale-location plot). You want to see no pattern here; if you notice a curved or cone-shaped pattern, that’s a red flag. Check for outliers and high leverage points: Cooks distance is a metric for identifying influential points. You can calculate this in R using cooks.distance(), which is one of several functions provided in the stats package for assessing influence. See ?influence.measures for details. It is a good idea to check for multicollinearity – to do this, you can start by estimating the variance inflation factor (VIF) values for each parameter in your model using the vif function from the car package. Rule of thumb: if any VIF values are greater than 10, the degree of multicollinearity in your model is causing your estimates to suffer. To deal with highly correlated values, you can try any of the following: 1. Where there are two or more variables that are measuring the same thing, narrow down the model to include just one of these variables. 2. Try [ridge regression](https://myweb.uiowa.edu/pbreheny/7240/s23/notes/2-02.pdf) 9.2.2 Examples: This article on STHDA gives some examples of residual plots in R. 9.2.3 R code tips This extended example shows how I fit a model, check diagnostics, and deal with multicollinearity: library(palmerpenguins) # example data &#39;penguins&#39; library(car) # has vif() function ## Loading required package: carData library(gtsummary) # to summarize model estimates # fit a regression model fit &lt;- lm(body_mass_g ~ ., data = penguins) # examine results fit |&gt; tbl_regression() |&gt; bold_labels() html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #fzheqzhbti .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #fzheqzhbti .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #fzheqzhbti .gt_caption { padding-top: 4px; padding-bottom: 4px; } #fzheqzhbti .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #fzheqzhbti .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #fzheqzhbti .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #fzheqzhbti .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #fzheqzhbti .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #fzheqzhbti .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #fzheqzhbti .gt_column_spanner_outer:first-child { padding-left: 0; } #fzheqzhbti .gt_column_spanner_outer:last-child { padding-right: 0; } #fzheqzhbti .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #fzheqzhbti .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #fzheqzhbti .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #fzheqzhbti .gt_from_md > :first-child { margin-top: 0; } #fzheqzhbti .gt_from_md > :last-child { margin-bottom: 0; } #fzheqzhbti .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #fzheqzhbti .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #fzheqzhbti .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #fzheqzhbti .gt_row_group_first td { border-top-width: 2px; } #fzheqzhbti .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #fzheqzhbti .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #fzheqzhbti .gt_first_summary_row.thick { border-top-width: 2px; } #fzheqzhbti .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #fzheqzhbti .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #fzheqzhbti .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #fzheqzhbti .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #fzheqzhbti .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #fzheqzhbti .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #fzheqzhbti .gt_footnote { margin: 0px; font-size: 90%; padding-left: 4px; padding-right: 4px; padding-left: 5px; padding-right: 5px; } #fzheqzhbti .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #fzheqzhbti .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #fzheqzhbti .gt_left { text-align: left; } #fzheqzhbti .gt_center { text-align: center; } #fzheqzhbti .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #fzheqzhbti .gt_font_normal { font-weight: normal; } #fzheqzhbti .gt_font_bold { font-weight: bold; } #fzheqzhbti .gt_font_italic { font-style: italic; } #fzheqzhbti .gt_super { font-size: 65%; } #fzheqzhbti .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #fzheqzhbti .gt_asterisk { font-size: 100%; vertical-align: 0; } #fzheqzhbti .gt_indent_1 { text-indent: 5px; } #fzheqzhbti .gt_indent_2 { text-indent: 10px; } #fzheqzhbti .gt_indent_3 { text-indent: 15px; } #fzheqzhbti .gt_indent_4 { text-indent: 20px; } #fzheqzhbti .gt_indent_5 { text-indent: 25px; } Characteristic Beta 95% CI1 p-value species     Adelie — —     Chinstrap -283 -457, -108 0.002     Gentoo 891 607, 1,175 island     Biscoe — —     Dream -21 -136, 94 0.7     Torgersen -59 -178, 61 0.3 bill_length_mm 19 5.0, 33 0.008 bill_depth_mm 61 21, 100 0.003 flipper_length_mm 19 12, 25 sex     female — —     male 379 284, 474 year -43 -84, -1.6 0.042 1 CI = Confidence Interval # take note: some of these confidence intervals are ~super~ wide # check assumptions (this gives me 4 plots): par(mfrow=c(2,2)) plot(fit) # first plot checks linearity -- looks good # second plot checks normality -- beautiful # third plot checks heteroskedasticity - no evidence of an issue here # 4th plot checks for outliers/leverage -- looks like we do have a couple of # outliers. Will proceed with caution... # check for multicollinearity: car::vif(fit) ## GVIF Df GVIF^(1/(2*Df)) ## species 71.200285 2 2.904828 ## island 3.762055 2 1.392696 ## bill_length_mm 6.117069 1 2.473271 ## bill_depth_mm 6.274341 1 2.504864 ## flipper_length_mm 7.775036 1 2.788375 ## sex 2.343434 1 1.530828 ## year 1.172956 1 1.083031 # Note: Very high VIF for species. Flipper length also has a moderately high VIF # visualize correlations: library(corrplot) # Love this package ## corrplot 0.92 loaded # to assess correlations between variables, use the design matrix X: X &lt;- model.matrix(fit)[,-1] corrplot(corr = cor(X)) gtsummary can summarize a regression model in a pretty table. Example: # using our penguins data again... fit2 &lt;- lm(bill_length_mm ~ sex + year + species, data = penguins) fit2 |&gt; tbl_regression() |&gt; bold_labels() html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #cmrvvfdofb .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #cmrvvfdofb .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #cmrvvfdofb .gt_caption { padding-top: 4px; padding-bottom: 4px; } #cmrvvfdofb .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #cmrvvfdofb .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #cmrvvfdofb .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #cmrvvfdofb .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #cmrvvfdofb .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #cmrvvfdofb .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #cmrvvfdofb .gt_column_spanner_outer:first-child { padding-left: 0; } #cmrvvfdofb .gt_column_spanner_outer:last-child { padding-right: 0; } #cmrvvfdofb .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #cmrvvfdofb .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #cmrvvfdofb .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #cmrvvfdofb .gt_from_md > :first-child { margin-top: 0; } #cmrvvfdofb .gt_from_md > :last-child { margin-bottom: 0; } #cmrvvfdofb .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #cmrvvfdofb .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #cmrvvfdofb .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #cmrvvfdofb .gt_row_group_first td { border-top-width: 2px; } #cmrvvfdofb .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #cmrvvfdofb .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #cmrvvfdofb .gt_first_summary_row.thick { border-top-width: 2px; } #cmrvvfdofb .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #cmrvvfdofb .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #cmrvvfdofb .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #cmrvvfdofb .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #cmrvvfdofb .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #cmrvvfdofb .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #cmrvvfdofb .gt_footnote { margin: 0px; font-size: 90%; padding-left: 4px; padding-right: 4px; padding-left: 5px; padding-right: 5px; } #cmrvvfdofb .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #cmrvvfdofb .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #cmrvvfdofb .gt_left { text-align: left; } #cmrvvfdofb .gt_center { text-align: center; } #cmrvvfdofb .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #cmrvvfdofb .gt_font_normal { font-weight: normal; } #cmrvvfdofb .gt_font_bold { font-weight: bold; } #cmrvvfdofb .gt_font_italic { font-style: italic; } #cmrvvfdofb .gt_super { font-size: 65%; } #cmrvvfdofb .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #cmrvvfdofb .gt_asterisk { font-size: 100%; vertical-align: 0; } #cmrvvfdofb .gt_indent_1 { text-indent: 5px; } #cmrvvfdofb .gt_indent_2 { text-indent: 10px; } #cmrvvfdofb .gt_indent_3 { text-indent: 15px; } #cmrvvfdofb .gt_indent_4 { text-indent: 20px; } #cmrvvfdofb .gt_indent_5 { text-indent: 25px; } Characteristic Beta 95% CI1 p-value sex     female — —     male 3.7 3.2, 4.2 year 0.32 0.02, 0.63 0.039 species     Adelie — —     Chinstrap 10 9.4, 11     Gentoo 8.7 8.1, 9.3 1 CI = Confidence Interval "]]
