<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 The basics: t-tests, ANOVA, and linear regression | A Reference Manual for the Biostatistics GRA</title>
  <meta name="description" content="This is a reference manual for training graduate research assistants in biostatistics and related fields." />
  <meta name="generator" content="bookdown 0.32 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 The basics: t-tests, ANOVA, and linear regression | A Reference Manual for the Biostatistics GRA" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a reference manual for training graduate research assistants in biostatistics and related fields." />
  <meta name="github-repo" content="tabpeter/ra_training_manual" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 The basics: t-tests, ANOVA, and linear regression | A Reference Manual for the Biostatistics GRA" />
  
  <meta name="twitter:description" content="This is a reference manual for training graduate research assistants in biostatistics and related fields." />
  

<meta name="author" content="T. K. Peter" />


<meta name="date" content="2023-05-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="giving-presentations.html"/>
<link rel="next" href="power-and-sample-size-calculations.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Reference Manual for the Biostatistics Research Assistant</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> url: your book url like https://bookdown.org/yihui/bookdown</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#what-this-book-assumes"><i class="fa fa-check"></i><b>1.1</b> What this book assumes</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#acronyms"><i class="fa fa-check"></i><b>1.2</b> Acronymns</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#working-with-the-garage-door-open"><i class="fa fa-check"></i><b>1.3</b> Working with the garage door open</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#dedication"><i class="fa fa-check"></i><b>1.4</b> Dedication</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="first-principles---invisible-and-integral-work.html"><a href="first-principles---invisible-and-integral-work.html"><i class="fa fa-check"></i><b>2</b> First Principles - invisible and integral work</a></li>
<li class="chapter" data-level="3" data-path="getting-organized-the-first-3-days-of-a-new-ra-job.html"><a href="getting-organized-the-first-3-days-of-a-new-ra-job.html"><i class="fa fa-check"></i><b>3</b> Getting organized: The first 3 days of a new RA job</a>
<ul>
<li class="chapter" data-level="3.1" data-path="getting-organized-the-first-3-days-of-a-new-ra-job.html"><a href="getting-organized-the-first-3-days-of-a-new-ra-job.html#file-structure"><i class="fa fa-check"></i><b>3.1</b> File structure</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="getting-organized-the-first-3-days-of-a-new-ra-job.html"><a href="getting-organized-the-first-3-days-of-a-new-ra-job.html#folder-video"><i class="fa fa-check"></i><b>3.1.1</b> Folder setup video</a></li>
<li class="chapter" data-level="3.1.2" data-path="getting-organized-the-first-3-days-of-a-new-ra-job.html"><a href="getting-organized-the-first-3-days-of-a-new-ra-job.html#please-use-relative-file-paths"><i class="fa fa-check"></i><b>3.1.2</b> Please use relative file paths</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="getting-organized-the-first-3-days-of-a-new-ra-job.html"><a href="getting-organized-the-first-3-days-of-a-new-ra-job.html#emails"><i class="fa fa-check"></i><b>3.2</b> Emails</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="getting-organized-the-first-3-days-of-a-new-ra-job.html"><a href="getting-organized-the-first-3-days-of-a-new-ra-job.html#organizing-your-inbox"><i class="fa fa-check"></i><b>3.2.1</b> Organizing your inbox</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="getting-organized-the-first-3-days-of-a-new-ra-job.html"><a href="getting-organized-the-first-3-days-of-a-new-ra-job.html#project-notes"><i class="fa fa-check"></i><b>3.3</b> Project notes and README files</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="getting-organized-the-first-3-days-of-a-new-ra-job.html"><a href="getting-organized-the-first-3-days-of-a-new-ra-job.html#project-notes-1"><i class="fa fa-check"></i><b>3.3.1</b> Project notes</a></li>
<li class="chapter" data-level="3.3.2" data-path="getting-organized-the-first-3-days-of-a-new-ra-job.html"><a href="getting-organized-the-first-3-days-of-a-new-ra-job.html#readme"><i class="fa fa-check"></i><b>3.3.2</b> README files</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="taking-notes.html"><a href="taking-notes.html"><i class="fa fa-check"></i><b>4</b> Taking Notes</a>
<ul>
<li class="chapter" data-level="4.1" data-path="taking-notes.html"><a href="taking-notes.html#zettelkasten"><i class="fa fa-check"></i><b>4.1</b> The Zettlekasten system</a></li>
<li class="chapter" data-level="4.2" data-path="taking-notes.html"><a href="taking-notes.html#how-to-connect-your-notes"><i class="fa fa-check"></i><b>4.2</b> How to connect your notes</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html"><i class="fa fa-check"></i><b>5</b> Cultivating professionalism</a>
<ul>
<li class="chapter" data-level="5.1" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#data-management"><i class="fa fa-check"></i><b>5.1</b> Data management</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#write-a-data-management-plan"><i class="fa fa-check"></i><b>5.1.1</b> Write a data management plan</a></li>
<li class="chapter" data-level="5.1.2" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#specify-a-explicit-set-of-operating-procedures"><i class="fa fa-check"></i><b>5.1.2</b> Specify a explicit set of operating procedures</a></li>
<li class="chapter" data-level="5.1.3" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#create-a-data-dictionary"><i class="fa fa-check"></i><b>5.1.3</b> Create a data dictionary</a></li>
<li class="chapter" data-level="5.1.4" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#determine-a-data-storage-location"><i class="fa fa-check"></i><b>5.1.4</b> Determine a data storage location</a></li>
<li class="chapter" data-level="5.1.5" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#develop-an-analysis-plan"><i class="fa fa-check"></i><b>5.1.5</b> Develop an analysis plan</a></li>
<li class="chapter" data-level="5.1.6" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#archive-all-of-your-procedures"><i class="fa fa-check"></i><b>5.1.6</b> Archive all of your procedures</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#what-to-do-when"><i class="fa fa-check"></i><b>5.2</b> What to do when …</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#the-data-is-not-organized-in-a-way-that-is-conducive-to-analysis"><i class="fa fa-check"></i><b>5.2.1</b> The data is not organized in a way that is conducive to analysis</a></li>
<li class="chapter" data-level="5.2.2" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#the-data-accidentally-contain-hippa-protected-information"><i class="fa fa-check"></i><b>5.2.2</b> The data accidentally contain HIPPA protected information</a></li>
<li class="chapter" data-level="5.2.3" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#the-pi-is-insistent-on-presenting-results-in-a-way-that-i-believe-is-sub-optimal"><i class="fa fa-check"></i><b>5.2.3</b> The PI is insistent on presenting results in a way that I believe is sub-optimal</a></li>
<li class="chapter" data-level="5.2.4" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#i-realized-i-made-a-mistake-in-my-code"><i class="fa fa-check"></i><b>5.2.4</b> I realized I made a mistake in my code!</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#maintaining-a-cv"><i class="fa fa-check"></i><b>5.3</b> Maintaining a CV</a></li>
<li class="chapter" data-level="5.4" data-path="cultivating-professionalism.html"><a href="cultivating-professionalism.html#point-to-point"><i class="fa fa-check"></i><b>5.4</b> Responding to reviewers</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="your-computing-setup.html"><a href="your-computing-setup.html"><i class="fa fa-check"></i><b>6</b> Your computing setup</a>
<ul>
<li class="chapter" data-level="6.1" data-path="your-computing-setup.html"><a href="your-computing-setup.html#setting-up-r-and-rstudio-now-posit"><i class="fa fa-check"></i><b>6.1</b> Setting up R and RStudio (now Posit)</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="your-computing-setup.html"><a href="your-computing-setup.html#download-and-install-r"><i class="fa fa-check"></i><b>6.1.1</b> Download and install R</a></li>
<li class="chapter" data-level="6.1.2" data-path="your-computing-setup.html"><a href="your-computing-setup.html#download-and-install-rstudio"><i class="fa fa-check"></i><b>6.1.2</b> Download and install RStudio</a></li>
<li class="chapter" data-level="6.1.3" data-path="your-computing-setup.html"><a href="your-computing-setup.html#customize-rstudio"><i class="fa fa-check"></i><b>6.1.3</b> Customize RStudio</a></li>
<li class="chapter" data-level="6.1.4" data-path="your-computing-setup.html"><a href="your-computing-setup.html#setting-up-your-r-library"><i class="fa fa-check"></i><b>6.1.4</b> Setting up your R library</a></li>
<li class="chapter" data-level="6.1.5" data-path="your-computing-setup.html"><a href="your-computing-setup.html#tips-things-you-should-never-do-in-rrstudio"><i class="fa fa-check"></i><b>6.1.5</b> Tips: things you should never do in R/RStudio</a></li>
<li class="chapter" data-level="6.1.6" data-path="your-computing-setup.html"><a href="your-computing-setup.html#cool-keyboard-shortcuts-in-rrstudio"><i class="fa fa-check"></i><b>6.1.6</b> Cool keyboard shortcuts in R/RStudio</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="your-computing-setup.html"><a href="your-computing-setup.html#setting-up-your-terminal-i.e.-the-command-line"><i class="fa fa-check"></i><b>6.2</b> Setting up your terminal (i.e., the command line)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="your-computing-setup.html"><a href="your-computing-setup.html#resources-for-learning-the-command-line"><i class="fa fa-check"></i><b>6.2.1</b> Resources for learning the command line</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="your-computing-setup.html"><a href="your-computing-setup.html#getting-started-with-git"><i class="fa fa-check"></i><b>6.3</b> Getting started with Git</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="your-computing-setup.html"><a href="your-computing-setup.html#resources-for-learning-git"><i class="fa fa-check"></i><b>6.3.1</b> Resources for learning Git</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="your-computing-setup.html"><a href="your-computing-setup.html#using-high-performance-computing-clusters"><i class="fa fa-check"></i><b>6.4</b> Using high performance computing clusters</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="your-computing-setup.html"><a href="your-computing-setup.html#interactive-sessions-v.-submitting-jobs"><i class="fa fa-check"></i><b>6.4.1</b> Interactive sessions v. submitting jobs</a></li>
<li class="chapter" data-level="6.4.2" data-path="your-computing-setup.html"><a href="your-computing-setup.html#writing-your-first-bash-script"><i class="fa fa-check"></i><b>6.4.2</b> Writing your first bash script</a></li>
<li class="chapter" data-level="6.4.3" data-path="your-computing-setup.html"><a href="your-computing-setup.html#conda-environments-v.-module-configurations"><i class="fa fa-check"></i><b>6.4.3</b> Conda environments v. module configurations</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="your-computing-setup.html"><a href="your-computing-setup.html#advanced-r-and-some-julia"><i class="fa fa-check"></i><b>6.5</b> Advanced R and some Julia</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="writing-reports.html"><a href="writing-reports.html"><i class="fa fa-check"></i><b>7</b> Writing reports</a>
<ul>
<li class="chapter" data-level="7.1" data-path="writing-reports.html"><a href="writing-reports.html#what-makes-a-report-good"><i class="fa fa-check"></i><b>7.1</b> What makes a report ‘good’?</a></li>
<li class="chapter" data-level="7.2" data-path="writing-reports.html"><a href="writing-reports.html#tables"><i class="fa fa-check"></i><b>7.2</b> Tools for writing reports</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="giving-presentations.html"><a href="giving-presentations.html"><i class="fa fa-check"></i><b>8</b> Giving presentations</a>
<ul>
<li class="chapter" data-level="8.1" data-path="giving-presentations.html"><a href="giving-presentations.html#tools-for-giving-presentations"><i class="fa fa-check"></i><b>8.1</b> Tools for giving presentations</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="the-basics-t-tests-anova-and-linear-regression.html"><a href="the-basics-t-tests-anova-and-linear-regression.html"><i class="fa fa-check"></i><b>9</b> The basics: t-tests, ANOVA, and linear regression</a>
<ul>
<li class="chapter" data-level="9.1" data-path="the-basics-t-tests-anova-and-linear-regression.html"><a href="the-basics-t-tests-anova-and-linear-regression.html#t-tests-anova"><i class="fa fa-check"></i><b>9.1</b> t-tests &amp; ANOVA</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="the-basics-t-tests-anova-and-linear-regression.html"><a href="the-basics-t-tests-anova-and-linear-regression.html#assumptionsdiagnostics"><i class="fa fa-check"></i><b>9.1.1</b> Assumptions/diagnostics</a></li>
<li class="chapter" data-level="9.1.2" data-path="the-basics-t-tests-anova-and-linear-regression.html"><a href="the-basics-t-tests-anova-and-linear-regression.html#examples"><i class="fa fa-check"></i><b>9.1.2</b> Examples:</a></li>
<li class="chapter" data-level="9.1.3" data-path="the-basics-t-tests-anova-and-linear-regression.html"><a href="the-basics-t-tests-anova-and-linear-regression.html#r-code-tips"><i class="fa fa-check"></i><b>9.1.3</b> R code tips</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="the-basics-t-tests-anova-and-linear-regression.html"><a href="the-basics-t-tests-anova-and-linear-regression.html#linear-regression"><i class="fa fa-check"></i><b>9.2</b> Linear regression</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="the-basics-t-tests-anova-and-linear-regression.html"><a href="the-basics-t-tests-anova-and-linear-regression.html#assumptionsdiagnostics-1"><i class="fa fa-check"></i><b>9.2.1</b> Assumptions/diagnostics</a></li>
<li class="chapter" data-level="9.2.2" data-path="the-basics-t-tests-anova-and-linear-regression.html"><a href="the-basics-t-tests-anova-and-linear-regression.html#examples-1"><i class="fa fa-check"></i><b>9.2.2</b> Examples:</a></li>
<li class="chapter" data-level="9.2.3" data-path="the-basics-t-tests-anova-and-linear-regression.html"><a href="the-basics-t-tests-anova-and-linear-regression.html#r-code-tips-1"><i class="fa fa-check"></i><b>9.2.3</b> R code tips</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="power-and-sample-size-calculations.html"><a href="power-and-sample-size-calculations.html"><i class="fa fa-check"></i><b>10</b> Power and sample size calculations</a>
<ul>
<li class="chapter" data-level="10.1" data-path="power-and-sample-size-calculations.html"><a href="power-and-sample-size-calculations.html#sas"><i class="fa fa-check"></i><b>10.1</b> SAS</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="survival-time-to-event-analysis.html"><a href="survival-time-to-event-analysis.html"><i class="fa fa-check"></i><b>11</b> Survival (time-to-event) analysis</a>
<ul>
<li class="chapter" data-level="11.1" data-path="survival-time-to-event-analysis.html"><a href="survival-time-to-event-analysis.html#assumptionsdiagnostics-2"><i class="fa fa-check"></i><b>11.1</b> Assumptions/diagnostics</a></li>
<li class="chapter" data-level="11.2" data-path="survival-time-to-event-analysis.html"><a href="survival-time-to-event-analysis.html#examples-2"><i class="fa fa-check"></i><b>11.2</b> Examples:</a></li>
<li class="chapter" data-level="11.3" data-path="survival-time-to-event-analysis.html"><a href="survival-time-to-event-analysis.html#r-code-tips-2"><i class="fa fa-check"></i><b>11.3</b> R code tips</a></li>
<li class="chapter" data-level="11.4" data-path="survival-time-to-event-analysis.html"><a href="survival-time-to-event-analysis.html#references"><i class="fa fa-check"></i><b>11.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="survey-data-analysis.html"><a href="survey-data-analysis.html"><i class="fa fa-check"></i><b>12</b> Survey data analysis</a>
<ul>
<li class="chapter" data-level="12.1" data-path="survey-data-analysis.html"><a href="survey-data-analysis.html#tools-for-analyzing-survey-data"><i class="fa fa-check"></i><b>12.1</b> Tools for analyzing survey data</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="longitudinal-data-analysis.html"><a href="longitudinal-data-analysis.html"><i class="fa fa-check"></i><b>13</b> Longitudinal data analysis</a>
<ul>
<li class="chapter" data-level="13.1" data-path="longitudinal-data-analysis.html"><a href="longitudinal-data-analysis.html#tools-for-longitudinal-data-analysis"><i class="fa fa-check"></i><b>13.1</b> Tools for longitudinal data analysis</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="microbiome-data-analysis.html"><a href="microbiome-data-analysis.html"><i class="fa fa-check"></i><b>14</b> Microbiome data analysis</a>
<ul>
<li class="chapter" data-level="14.1" data-path="microbiome-data-analysis.html"><a href="microbiome-data-analysis.html#tools-for-working-with-microbiome-data"><i class="fa fa-check"></i><b>14.1</b> Tools for working with microbiome data</a></li>
</ul></li>
<li class="chapter" data-level="15" data-path="genetics-gwas-data-analysis.html"><a href="genetics-gwas-data-analysis.html"><i class="fa fa-check"></i><b>15</b> Genetics (GWAS) data analysis</a>
<ul>
<li class="chapter" data-level="15.1" data-path="genetics-gwas-data-analysis.html"><a href="genetics-gwas-data-analysis.html#r-packages"><i class="fa fa-check"></i><b>15.1</b> R packages</a></li>
<li class="chapter" data-level="15.2" data-path="genetics-gwas-data-analysis.html"><a href="genetics-gwas-data-analysis.html#command-line-tools"><i class="fa fa-check"></i><b>15.2</b> Command-line tools</a></li>
</ul></li>
<li class="chapter" data-level="16" data-path="geographic-gis-data-analysis.html"><a href="geographic-gis-data-analysis.html"><i class="fa fa-check"></i><b>16</b> Geographic (GIS) data analysis</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">A Reference Manual for the Biostatistics GRA</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="the-basics-t-tests-anova-and-linear-regression" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> The basics: t-tests, ANOVA, and linear regression<a href="the-basics-t-tests-anova-and-linear-regression.html#the-basics-t-tests-anova-and-linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The most basic statistical analyses for a GRA to use are t-tests, analysis of variance, and linear regression. Here are some tips and references for getting started using any of these tools:</p>
<div id="t-tests-anova" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> t-tests &amp; ANOVA<a href="the-basics-t-tests-anova-and-linear-regression.html#t-tests-anova" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Many t-test and ANOVA results can be implemented by the same functions I’ve suggested for creating <a href="writing-reports.html#tables">summary tables</a>.</p>
<div id="assumptionsdiagnostics" class="section level3 hasAnchor" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Assumptions/diagnostics<a href="the-basics-t-tests-anova-and-linear-regression.html#assumptionsdiagnostics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="examples" class="section level3 hasAnchor" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Examples:<a href="the-basics-t-tests-anova-and-linear-regression.html#examples" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="r-code-tips" class="section level3 hasAnchor" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> R code tips<a href="the-basics-t-tests-anova-and-linear-regression.html#r-code-tips" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="linear-regression" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Linear regression<a href="the-basics-t-tests-anova-and-linear-regression.html#linear-regression" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="assumptionsdiagnostics-1" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Assumptions/diagnostics<a href="the-basics-t-tests-anova-and-linear-regression.html#assumptionsdiagnostics-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As the <a href="https://sphweb.bumc.bu.edu/otlt/MPH-Modules/BS/R/R5_Correlation-Regression/R5_Correlation-Regression7.html">regression diagnostics page</a> at Boston University explains, there are 4 key assumptions in linear regression:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Linearity</strong>: the data <span class="math inline">\(X\)</span> are in a linear relationship with the mean of the outcome <span class="math inline">\(\hat Y\)</span></p></li>
<li><p><strong>Homoskedasticity</strong>: The variance of the residual <span class="math inline">\(\sigma^2\)</span> is the same for all observations of <span class="math inline">\(X\)</span>.</p></li>
<li><p><strong>Independence</strong>: For all observations <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>, <span class="math inline">\(i \perp j\)</span>.</p></li>
<li><p><strong>Normality</strong>: The residuals <span class="math inline">\(\textbf{r} \equiv Y - X\beta\)</span> are distributed normally.</p></li>
</ol>
<p>When using a linear model, here are the diagnostics you should check:</p>
<ol style="list-style-type: decimal">
<li><p>Check the linearity assumption: make a plot of the residuals <span class="math inline">\(\textbf{r}\)</span> versus the fitted values <span class="math inline">\(\hat{\mathbf{Y}}\)</span>. If this assumption holds, you should see a horizontal line without a distinct pattern. Patterns like a cone-shape or a curve are red flags.</p></li>
<li><p>Check the normality assumption: Make a QQ plot of the residuals using <code>qqnorm</code> and <code>qqline</code>. If the normality assumption is reasonable, the points should fall on the diagonal line drawn by <code>qqline</code>. You could also make a histogram of the residuals and see if the histogram has a bell-curve shape. <strong>Note</strong>: plotting the observed outcomes <span class="math inline">\(Y\)</span> is <em>not</em> the same as checking this assumption. The linearity assumption pertains to the residuals being bell-curve shaped, not the observed outcome values.</p></li>
<li><p>Check the heteroskedasticity assumption: Plot the standardized residuals versus the fitted values (this is a scale-location plot). You want to see no pattern here; if you notice a curved or cone-shaped pattern, that’s a red flag.</p></li>
<li><p>Check for outliers and high leverage points: <a href="https://en.wikipedia.org/wiki/Cook%27s_distance">Cooks distance</a> is a metric for identifying influential points. You can calculate this in <code>R</code> using <code>cooks.distance()</code>, which is one of several functions provided in the <code>stats</code> package for assessing influence. See <code>?influence.measures</code> for details.</p></li>
<li><p>It is a good idea to check for <a href="https://en.wikipedia.org/wiki/Multicollinearity">multicollinearity</a> – to do this, you can start by estimating the <a href="https://en.wikipedia.org/wiki/Variance_inflation_factor">variance inflation factor</a> (VIF) values for each parameter in your model using the <code>vif</code> function from the <code>car</code> package. Rule of thumb: if any VIF values are greater than 10, the degree of multicollinearity in your model is causing your estimates to suffer. To deal with highly correlated values, you can try any of the following:</p></li>
<li><p>Where there are two or more variables that are measuring the same thing, narrow down the model to include just one of these variables.</p></li>
<li><p>Try <a href="https://myweb.uiowa.edu/pbreheny/7240/s23/notes/2-02.pdf">ridge regression</a></p></li>
</ol>
</div>
<div id="examples-1" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Examples:<a href="the-basics-t-tests-anova-and-linear-regression.html#examples-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>This article on <a href="http://www.sthda.com/english/articles/39-regression-model-diagnostics/161-linear-regression-assumptions-and-diagnostics-in-r-essentials/">STHDA</a> gives some examples of residual plots in <code>R</code>.</li>
</ul>
</div>
<div id="r-code-tips-1" class="section level3 hasAnchor" number="9.2.3">
<h3><span class="header-section-number">9.2.3</span> R code tips<a href="the-basics-t-tests-anova-and-linear-regression.html#r-code-tips-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This extended example shows how I fit a model, check diagnostics, and deal with multicollinearity:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(palmerpenguins) <span class="co"># example data &#39;penguins&#39; </span></span>
<span id="cb1-2"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car) <span class="co"># has vif() function </span></span></code></pre></div>
<pre><code>## Loading required package: carData</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary) <span class="co"># to summarize model estimates </span></span>
<span id="cb3-2"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># fit a regression model </span></span>
<span id="cb3-4"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb3-4" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass_g <span class="sc">~</span> .,</span>
<span id="cb3-5"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb3-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> penguins) </span>
<span id="cb3-6"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># examine results </span></span>
<span id="cb3-8"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb3-8" aria-hidden="true" tabindex="-1"></a>fit <span class="sc">|&gt;</span> </span>
<span id="cb3-9"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_regression</span>() <span class="sc">|&gt;</span> </span>
<span id="cb3-10"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>()</span></code></pre></div>
<div id="tqbhefydhh" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#tqbhefydhh .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#tqbhefydhh .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tqbhefydhh .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#tqbhefydhh .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#tqbhefydhh .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#tqbhefydhh .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tqbhefydhh .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#tqbhefydhh .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#tqbhefydhh .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#tqbhefydhh .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#tqbhefydhh .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#tqbhefydhh .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#tqbhefydhh .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#tqbhefydhh .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#tqbhefydhh .gt_from_md > :first-child {
  margin-top: 0;
}

#tqbhefydhh .gt_from_md > :last-child {
  margin-bottom: 0;
}

#tqbhefydhh .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#tqbhefydhh .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#tqbhefydhh .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#tqbhefydhh .gt_row_group_first td {
  border-top-width: 2px;
}

#tqbhefydhh .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tqbhefydhh .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#tqbhefydhh .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#tqbhefydhh .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tqbhefydhh .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#tqbhefydhh .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#tqbhefydhh .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#tqbhefydhh .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#tqbhefydhh .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tqbhefydhh .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tqbhefydhh .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#tqbhefydhh .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#tqbhefydhh .gt_left {
  text-align: left;
}

#tqbhefydhh .gt_center {
  text-align: center;
}

#tqbhefydhh .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#tqbhefydhh .gt_font_normal {
  font-weight: normal;
}

#tqbhefydhh .gt_font_bold {
  font-weight: bold;
}

#tqbhefydhh .gt_font_italic {
  font-style: italic;
}

#tqbhefydhh .gt_super {
  font-size: 65%;
}

#tqbhefydhh .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#tqbhefydhh .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#tqbhefydhh .gt_indent_1 {
  text-indent: 5px;
}

#tqbhefydhh .gt_indent_2 {
  text-indent: 10px;
}

#tqbhefydhh .gt_indent_3 {
  text-indent: 15px;
}

#tqbhefydhh .gt_indent_4 {
  text-indent: 20px;
}

#tqbhefydhh .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Characteristic&lt;/strong&gt;"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Beta&lt;/strong&gt;"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;95% CI&lt;/strong&gt;&lt;sup class=&quot;gt_footnote_marks&quot;&gt;1&lt;/sup&gt;"><strong>95% CI</strong><sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;p-value&lt;/strong&gt;"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">species</td>
<td headers="estimate" class="gt_row gt_center"></td>
<td headers="ci" class="gt_row gt_center"></td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Adelie</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Chinstrap</td>
<td headers="estimate" class="gt_row gt_center">-283</td>
<td headers="ci" class="gt_row gt_center">-457, -108</td>
<td headers="p.value" class="gt_row gt_center">0.002</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Gentoo</td>
<td headers="estimate" class="gt_row gt_center">891</td>
<td headers="ci" class="gt_row gt_center">607, 1,175</td>
<td headers="p.value" class="gt_row gt_center"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">island</td>
<td headers="estimate" class="gt_row gt_center"></td>
<td headers="ci" class="gt_row gt_center"></td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Biscoe</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Dream</td>
<td headers="estimate" class="gt_row gt_center">-21</td>
<td headers="ci" class="gt_row gt_center">-136, 94</td>
<td headers="p.value" class="gt_row gt_center">0.7</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Torgersen</td>
<td headers="estimate" class="gt_row gt_center">-59</td>
<td headers="ci" class="gt_row gt_center">-178, 61</td>
<td headers="p.value" class="gt_row gt_center">0.3</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">bill_length_mm</td>
<td headers="estimate" class="gt_row gt_center">19</td>
<td headers="ci" class="gt_row gt_center">5.0, 33</td>
<td headers="p.value" class="gt_row gt_center">0.008</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">bill_depth_mm</td>
<td headers="estimate" class="gt_row gt_center">61</td>
<td headers="ci" class="gt_row gt_center">21, 100</td>
<td headers="p.value" class="gt_row gt_center">0.003</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">flipper_length_mm</td>
<td headers="estimate" class="gt_row gt_center">19</td>
<td headers="ci" class="gt_row gt_center">12, 25</td>
<td headers="p.value" class="gt_row gt_center"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">sex</td>
<td headers="estimate" class="gt_row gt_center"></td>
<td headers="ci" class="gt_row gt_center"></td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    female</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    male</td>
<td headers="estimate" class="gt_row gt_center">379</td>
<td headers="ci" class="gt_row gt_center">284, 474</td>
<td headers="p.value" class="gt_row gt_center"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">year</td>
<td headers="estimate" class="gt_row gt_center">-43</td>
<td headers="ci" class="gt_row gt_center">-84, -1.6</td>
<td headers="p.value" class="gt_row gt_center">0.042</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><sup class="gt_footnote_marks">1</sup> CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># take note: some of these confidence intervals are ~super~ wide</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check assumptions (this gives me 4 plots): </span></span>
<span id="cb5-2"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb5-3"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Notes from diagnostic plots:</p>
<ul>
<li>first plot checks linearity – looks good</li>
<li>second plot checks normality – beautiful</li>
<li>third plot checks heteroskedasticity - no evidence of an issue here</li>
<li>4th plot checks for outliers/leverage – looks like we do have a couple of outliers. Will proceed with caution…</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check for multicollinearity: </span></span>
<span id="cb6-2"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb6-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">vif</span>(fit) </span></code></pre></div>
<pre><code>##                        GVIF Df GVIF^(1/(2*Df))
## species           71.200285  2        2.904828
## island             3.762055  2        1.392696
## bill_length_mm     6.117069  1        2.473271
## bill_depth_mm      6.274341  1        2.504864
## flipper_length_mm  7.775036  1        2.788375
## sex                2.343434  1        1.530828
## year               1.172956  1        1.083031</code></pre>
<p>Note: Very high VIF for species. Flipper length also has a moderately high VIF</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualize correlations: </span></span>
<span id="cb8-2"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot) <span class="co"># Love this package </span></span></code></pre></div>
<pre><code>## corrplot 0.92 loaded</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># to assess correlations between variables, use the design matrix X: </span></span>
<span id="cb10-2"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb10-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(fit)[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb10-3"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="at">corr =</span> <span class="fu">cor</span>(X)) </span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>Now we see the problem: there are notable correlations between species and several other variables. Suppose the research question involves comparing the species of penguins, e.g., “We aim to assess whether/how body mass (measured in grams) varies between penguins of three species: the Adelie, the Chinstrap, and the Gentoo.” In this kind of context, the bill length and flipper length variables are not directly related to the research question. Also, ‘island’ seems to be capturing the same information as ‘species.’ In this case, I would eliminate these redundant variables from the model and create a reduced fit:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb11-1" aria-hidden="true" tabindex="-1"></a>fit_reduc <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass_g <span class="sc">~</span> species <span class="sc">+</span> sex <span class="sc">+</span> year, </span>
<span id="cb11-2"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb11-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> penguins)</span>
<span id="cb11-3"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb11-4" aria-hidden="true" tabindex="-1"></a>fit_reduc <span class="sc">|&gt;</span> </span>
<span id="cb11-5"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tbl_regression</span>() <span class="sc">|&gt;</span> </span>
<span id="cb11-6"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bold_labels</span>()</span></code></pre></div>
<div id="bxqtnusqon" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#bxqtnusqon .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#bxqtnusqon .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bxqtnusqon .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#bxqtnusqon .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#bxqtnusqon .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#bxqtnusqon .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxqtnusqon .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#bxqtnusqon .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#bxqtnusqon .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#bxqtnusqon .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#bxqtnusqon .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#bxqtnusqon .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#bxqtnusqon .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#bxqtnusqon .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#bxqtnusqon .gt_from_md > :first-child {
  margin-top: 0;
}

#bxqtnusqon .gt_from_md > :last-child {
  margin-bottom: 0;
}

#bxqtnusqon .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#bxqtnusqon .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#bxqtnusqon .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#bxqtnusqon .gt_row_group_first td {
  border-top-width: 2px;
}

#bxqtnusqon .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxqtnusqon .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#bxqtnusqon .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#bxqtnusqon .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxqtnusqon .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxqtnusqon .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#bxqtnusqon .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#bxqtnusqon .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#bxqtnusqon .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bxqtnusqon .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-left: 4px;
  padding-right: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxqtnusqon .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#bxqtnusqon .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#bxqtnusqon .gt_left {
  text-align: left;
}

#bxqtnusqon .gt_center {
  text-align: center;
}

#bxqtnusqon .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#bxqtnusqon .gt_font_normal {
  font-weight: normal;
}

#bxqtnusqon .gt_font_bold {
  font-weight: bold;
}

#bxqtnusqon .gt_font_italic {
  font-style: italic;
}

#bxqtnusqon .gt_super {
  font-size: 65%;
}

#bxqtnusqon .gt_footnote_marks {
  font-style: italic;
  font-weight: normal;
  font-size: 75%;
  vertical-align: 0.4em;
}

#bxqtnusqon .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#bxqtnusqon .gt_indent_1 {
  text-indent: 5px;
}

#bxqtnusqon .gt_indent_2 {
  text-indent: 10px;
}

#bxqtnusqon .gt_indent_3 {
  text-indent: 15px;
}

#bxqtnusqon .gt_indent_4 {
  text-indent: 20px;
}

#bxqtnusqon .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table">
  
  <thead class="gt_col_headings">
    <tr>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Characteristic&lt;/strong&gt;"><strong>Characteristic</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;Beta&lt;/strong&gt;"><strong>Beta</strong></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;95% CI&lt;/strong&gt;&lt;sup class=&quot;gt_footnote_marks&quot;&gt;1&lt;/sup&gt;"><strong>95% CI</strong><sup class="gt_footnote_marks">1</sup></th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="&lt;strong&gt;p-value&lt;/strong&gt;"><strong>p-value</strong></th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">species</td>
<td headers="estimate" class="gt_row gt_center"></td>
<td headers="ci" class="gt_row gt_center"></td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Adelie</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Chinstrap</td>
<td headers="estimate" class="gt_row gt_center">27</td>
<td headers="ci" class="gt_row gt_center">-64, 119</td>
<td headers="p.value" class="gt_row gt_center">0.6</td></tr>
    <tr><td headers="label" class="gt_row gt_left">    Gentoo</td>
<td headers="estimate" class="gt_row gt_center">1,378</td>
<td headers="ci" class="gt_row gt_center">1,301, 1,455</td>
<td headers="p.value" class="gt_row gt_center"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">sex</td>
<td headers="estimate" class="gt_row gt_center"></td>
<td headers="ci" class="gt_row gt_center"></td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    female</td>
<td headers="estimate" class="gt_row gt_center">—</td>
<td headers="ci" class="gt_row gt_center">—</td>
<td headers="p.value" class="gt_row gt_center"></td></tr>
    <tr><td headers="label" class="gt_row gt_left">    male</td>
<td headers="estimate" class="gt_row gt_center">668</td>
<td headers="ci" class="gt_row gt_center">599, 736</td>
<td headers="p.value" class="gt_row gt_center"><0.001</td></tr>
    <tr><td headers="label" class="gt_row gt_left" style="font-weight: bold;">year</td>
<td headers="estimate" class="gt_row gt_center">3.6</td>
<td headers="ci" class="gt_row gt_center">-39, 46</td>
<td headers="p.value" class="gt_row gt_center">0.9</td></tr>
  </tbody>
  
  <tfoot class="gt_footnotes">
    <tr>
      <td class="gt_footnote" colspan="4"><sup class="gt_footnote_marks">1</sup> CI = Confidence Interval</td>
    </tr>
  </tfoot>
</table>
</div>
<p>Notice that the revised model has a much more reasonable confidence interval for ‘species’, and the coefficient representing the impact of ‘Chinstrap’ species is no longer significant. However, using the <a href="https://en.wikipedia.org/wiki/Akaike_information_criterion">AIC</a> to assess model fit, we see that our reduced model does not fit our data as well as the model with all the coefficients:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC: lower is better</span></span>
<span id="cb12-2"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(fit); <span class="fu">AIC</span>(fit_reduc)</span></code></pre></div>
<pre><code>## [1] 4724.97</code></pre>
<pre><code>## [1] 4787.564</code></pre>
<p>A better approach may be using ridge regression:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(hdrm) <span class="co"># for ridge() function </span></span></code></pre></div>
<pre><code>## Loading required package: glmnet</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## Loaded glmnet 4.1-7</code></pre>
<pre><code>## Loading required package: ncvreg</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr) <span class="co"># for kable() function </span></span>
<span id="cb20-2"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># fit model with lambda sequence </span></span>
<span id="cb20-4"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb20-4" aria-hidden="true" tabindex="-1"></a>fit_ridge <span class="ot">&lt;-</span> <span class="fu">ridge</span>(body_mass_g <span class="sc">~</span> .,</span>
<span id="cb20-5"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb20-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> penguins) </span>
<span id="cb20-6"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co"># look at results </span></span>
<span id="cb20-7"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit_ridge)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># choose lambda that minimizes GCV</span></span>
<span id="cb21-2"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb21-2" aria-hidden="true" tabindex="-1"></a>bestlam <span class="ot">&lt;-</span> fit_ridge<span class="sc">$</span>lambda[<span class="fu">which.min</span>(fit_ridge<span class="sc">$</span>GCV)]</span>
<span id="cb21-3"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="co"># re-fit model at best lambda </span></span>
<span id="cb21-4"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb21-4" aria-hidden="true" tabindex="-1"></a>fit_ridge <span class="ot">&lt;-</span> <span class="fu">ridge</span>(body_mass_g <span class="sc">~</span> .,</span>
<span id="cb21-5"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb21-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> penguins,</span>
<span id="cb21-6"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb21-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">lambda =</span> bestlam)</span>
<span id="cb21-7"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># summarize results (no gtsummary function for this, so I build my own table)</span></span>
<span id="cb21-8"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb21-8" aria-hidden="true" tabindex="-1"></a>res_ridge <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">OR =</span> <span class="fu">exp</span>(<span class="fu">coef</span>(fit_ridge)),</span>
<span id="cb21-9"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb21-9" aria-hidden="true" tabindex="-1"></a>                        <span class="fu">exp</span>(<span class="fu">confint</span>(fit_ridge)),</span>
<span id="cb21-10"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb21-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">p =</span> <span class="fu">summary</span>(fit_ridge)[,<span class="dv">4</span>] <span class="sc">|&gt;</span> <span class="fu">format.pval</span>(<span class="at">digits=</span><span class="dv">2</span>,</span>
<span id="cb21-11"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb21-11" aria-hidden="true" tabindex="-1"></a>                                                                  <span class="at">eps=</span><span class="fl">0.01</span>))</span>
<span id="cb21-12"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb21-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-13"><a href="the-basics-t-tests-anova-and-linear-regression.html#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(res_ridge)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">OR</th>
<th align="right">Lower</th>
<th align="right">Upper</th>
<th align="left">p</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">Inf</td>
<td align="right">Inf</td>
<td align="right">Inf</td>
<td align="left">2.2</td>
</tr>
<tr class="even">
<td align="left">speciesChinstrap</td>
<td align="right">0.000000e+00</td>
<td align="right">0.000000e+00</td>
<td align="right">0.000000e+00</td>
<td align="left">&lt;0.01</td>
</tr>
<tr class="odd">
<td align="left">speciesGentoo</td>
<td align="right">Inf</td>
<td align="right">4.905289e+239</td>
<td align="right">Inf</td>
<td align="left">6.2</td>
</tr>
<tr class="even">
<td align="left">islandDream</td>
<td align="right">0.000000e+00</td>
<td align="right">0.000000e+00</td>
<td align="right">8.031780e+33</td>
<td align="left">&lt;0.01</td>
</tr>
<tr class="odd">
<td align="left">islandTorgersen</td>
<td align="right">0.000000e+00</td>
<td align="right">0.000000e+00</td>
<td align="right">8.515774e+20</td>
<td align="left">&lt;0.01</td>
</tr>
<tr class="even">
<td align="left">bill_length_mm</td>
<td align="right">7.620551e+08</td>
<td align="right">1.178649e+03</td>
<td align="right">4.927062e+14</td>
<td align="left">3.0</td>
</tr>
<tr class="odd">
<td align="left">bill_depth_mm</td>
<td align="right">1.479218e+22</td>
<td align="right">9.804621e+05</td>
<td align="right">2.231687e+38</td>
<td align="left">2.7</td>
</tr>
<tr class="even">
<td align="left">flipper_length_mm</td>
<td align="right">2.275824e+08</td>
<td align="right">6.806037e+05</td>
<td align="right">7.609971e+10</td>
<td align="left">6.5</td>
</tr>
<tr class="odd">
<td align="left">sexmale</td>
<td align="right">1.481501e+165</td>
<td align="right">8.282918e+124</td>
<td align="right">2.649845e+205</td>
<td align="left">8.1</td>
</tr>
<tr class="even">
<td align="left">year</td>
<td align="right">0.000000e+00</td>
<td align="right">0.000000e+00</td>
<td align="right">7.661000e-03</td>
<td align="left">&lt;0.01</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="giving-presentations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="power-and-sample-size-calculations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/tabpeter/ra_training_manual/edit/master/08-basics.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
